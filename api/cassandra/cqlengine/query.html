
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="refresh" content="0; URL=https://docs.datastax.com/en/developer/python-driver/latest/api/cassandra/cqlengine/query/">
    <link rel="canonical" href="https://docs.datastax.com/en/developer/python-driver/latest/api/cassandra/cqlengine/query/">
    <title>cassandra.cqlengine.query - Query and filter model objects &#8212; Cassandra Driver 3.13.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '3.13.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="cassandra.cqlengine.connection - Connection management for cqlengine" href="connection.html" />
    <link rel="prev" title="cassandra.cqlengine.columns - Column types for object mapping models" href="columns.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-cassandra.cqlengine.query">
<span id="cassandra-cqlengine-query-query-and-filter-model-objects"></span><h1><code class="docutils literal"><span class="pre">cassandra.cqlengine.query</span></code> - Query and filter model objects<a class="headerlink" href="#module-cassandra.cqlengine.query" title="Permalink to this headline">¶</a></h1>
<div class="section" id="queryset">
<h2>QuerySet<a class="headerlink" href="#queryset" title="Permalink to this headline">¶</a></h2>
<p>QuerySet objects are typically obtained by calling <code class="xref py py-meth docutils literal"><span class="pre">objects()</span></code> on a model class.
The methods here are used to filter, order, and constrain results.</p>
<dl class="class">
<dt id="cassandra.cqlengine.query.ModelQuerySet">
<em class="property">class </em><code class="descclassname">cassandra.cqlengine.query.</code><code class="descname">ModelQuerySet</code><span class="sig-paren">(</span><em>model</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#ModelQuerySet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.all">
<code class="descname">all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.all" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a queryset matching all rows</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.batch">
<code class="descname">batch</code><span class="sig-paren">(</span><em>batch_obj</em><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a batch object to run the query on.</p>
<p>Note: running a select query with a batch object will raise an exception</p>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.consistency">
<code class="descname">consistency</code><span class="sig-paren">(</span><em>consistency</em><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.consistency" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the consistency level for the operation. See <a class="reference internal" href="../../cassandra.html#cassandra.ConsistencyLevel" title="cassandra.ConsistencyLevel"><code class="xref py py-class docutils literal"><span class="pre">ConsistencyLevel</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">consistency</span><span class="p">(</span><span class="n">CL</span><span class="o">.</span><span class="n">ONE</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.count">
<code class="descname">count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of rows matched by this query.</p>
<p><em>Note: This function executes a SELECT COUNT() and has a performance cost on large datasets</em></p>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.len">
<code class="descname">len</code><span class="sig-paren">(</span><em>queryset</em><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.len" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of rows matched by this query. This function uses <a class="reference internal" href="#cassandra.cqlengine.query.ModelQuerySet.count" title="cassandra.cqlengine.query.ModelQuerySet.count"><code class="xref py py-meth docutils literal"><span class="pre">count()</span></code></a> internally.</p>
<p><em>Note: This function executes a SELECT COUNT() and has a performance cost on large datasets</em></p>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.distinct">
<code class="descname">distinct</code><span class="sig-paren">(</span><em>distinct_fields=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.distinct" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the DISTINCT rows matched by this query.</p>
<p>distinct_fields default to the partition key fields if not specified.</p>
<p><em>Note: distinct_fields must be a partition key or a static column</em></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Automobile</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">manufacturer</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">partition_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">price</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">Decimal</span><span class="p">()</span>

<span class="n">sync_table</span><span class="p">(</span><span class="n">Automobile</span><span class="p">)</span>

<span class="c1"># create rows</span>

<span class="n">Automobile</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>

<span class="c1"># or</span>

<span class="n">Automobile</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">distinct</span><span class="p">([</span><span class="s1">&#39;manufacturer&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.filter">
<code class="descname">filter</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds WHERE arguments to the queryset, returning a new queryset</p>
<p>See <a class="reference internal" href="../../../cqlengine/queryset.html#retrieving-objects-with-filters"><span class="std std-ref">Retrieving objects with filters</span></a></p>
<p>Returns a QuerySet filtered on the keyword arguments</p>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a single instance matching this query, optionally with additional filter kwargs.</p>
<p>See <a class="reference internal" href="../../../cqlengine/queryset.html#retrieving-objects-with-filters"><span class="std std-ref">Retrieving objects with filters</span></a></p>
<p>Returns a single object matching the QuerySet.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>If no objects are matched, a <a class="reference internal" href="#cassandra.cqlengine.query.DoesNotExist" title="cassandra.cqlengine.query.DoesNotExist"><code class="xref py py-class docutils literal"><span class="pre">DoesNotExist</span></code></a> exception is raised.</p>
<p>If more than one object is found, a <a class="reference internal" href="#cassandra.cqlengine.query.MultipleObjectsReturned" title="cassandra.cqlengine.query.MultipleObjectsReturned"><code class="xref py py-class docutils literal"><span class="pre">MultipleObjectsReturned</span></code></a> exception is raised.</p>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.limit">
<code class="descname">limit</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Limits the number of results returned by Cassandra. Use <em>0</em> or <em>None</em> to disable.</p>
<p><em>Note that CQL’s default limit is 10,000, so all queries without a limit set explicitly will have an implicit limit of 10,000</em></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Fetch 100 users</span>
<span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="p">()</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>

<span class="c1"># Fetch all users</span>
<span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="p">()</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.fetch_size">
<code class="descname">fetch_size</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.fetch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the number of rows that are fetched at a time.</p>
<p><em>Note that driver’s default fetch size is 5000.</em></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="p">()</span><span class="o">.</span><span class="n">fetch_size</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.if_not_exists">
<code class="descname">if_not_exists</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#ModelQuerySet.if_not_exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.if_not_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the existence of an object before insertion.</p>
<p>If the insertion isn’t applied, a LWTException is raised.</p>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.if_exists">
<code class="descname">if_exists</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#ModelQuerySet.if_exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.if_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the existence of an object before an update or delete.</p>
<p>If the update or delete isn’t applied, a LWTException is raised.</p>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.order_by">
<code class="descname">order_by</code><span class="sig-paren">(</span><em>*colnames</em><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.order_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the column(s) to be used for ordering</p>
<p>Default order is ascending, prepend a ‘-‘ to any column name for descending</p>
<p><em>Note: column names must be a clustering key</em></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">uuid</span> <span class="kn">import</span> <span class="n">uuid1</span><span class="p">,</span><span class="n">uuid4</span>

<span class="k">class</span> <span class="nc">Comment</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">photo_id</span> <span class="o">=</span> <span class="n">UUID</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">comment_id</span> <span class="o">=</span> <span class="n">TimeUUID</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">uuid1</span><span class="p">)</span> <span class="c1"># second primary key component is a clustering key</span>
    <span class="n">comment</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>

<span class="n">sync_table</span><span class="p">(</span><span class="n">Comment</span><span class="p">)</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">uuid4</span><span class="p">()</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">Comment</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">photo_id</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;test </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Normal&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">Comment</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="n">photo_id</span><span class="o">=</span><span class="n">u</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">comment</span><span class="o">.</span><span class="n">comment_id</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Reversed&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">Comment</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="n">photo_id</span><span class="o">=</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&quot;-comment_id&quot;</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">comment</span><span class="o">.</span><span class="n">comment_id</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.allow_filtering">
<code class="descname">allow_filtering</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.allow_filtering" title="Permalink to this definition">¶</a></dt>
<dd><p>Enables the (usually) unwise practive of querying on a clustering key without also defining a partition key</p>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.only">
<code class="descname">only</code><span class="sig-paren">(</span><em>fields</em><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.only" title="Permalink to this definition">¶</a></dt>
<dd><p>Load only these fields for the returned query</p>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.defer">
<code class="descname">defer</code><span class="sig-paren">(</span><em>fields</em><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.defer" title="Permalink to this definition">¶</a></dt>
<dd><p>Don’t load these fields for the returned query</p>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.timestamp">
<code class="descname">timestamp</code><span class="sig-paren">(</span><em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#ModelQuerySet.timestamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows for custom timestamps to be saved with the record.</p>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.ttl">
<code class="descname">ttl</code><span class="sig-paren">(</span><em>ttl</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#ModelQuerySet.ttl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.ttl" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the ttl (in seconds) for modified data.</p>
<p><em>Note that running a select query with a ttl value will raise an exception</em></p>
</dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.using">
<code class="descname">using</code><span class="sig-paren">(</span><em>keyspace=None</em>, <em>connection=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.using" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the context on-the-fly of the Model class (keyspace, connection)</p>
</dd></dl>

<span class="target" id="blind-updates"></span><dl class="method">
<dt id="cassandra.cqlengine.query.ModelQuerySet.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>**values</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#ModelQuerySet.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.ModelQuerySet.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs an update on the row selected by the queryset. Include values to update in the
update like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Model</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Passing in updates for columns which are not part of the model will raise a ValidationError.</p>
<p>Per column validation will be performed, but instance level validation will not
(i.e., <cite>Model.validate</cite> is not called).  This is sometimes referred to as a blind update.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>

<span class="n">setup</span><span class="p">([</span><span class="s2">&quot;localhost&quot;</span><span class="p">],</span> <span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">sync_table</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;jon&quot;</span><span class="p">)</span>

<span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Steve&quot;</span><span class="p">)</span>

<span class="c1"># sets name to null</span>
<span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Also supported is blindly adding and removing elements from container columns,
without loading a model instance from Cassandra.</p>
<p>Using the syntax <cite>.update(column_name={x, y, z})</cite> will overwrite the contents of the container, like updating a
non container column. However, adding <cite>__&lt;operation&gt;</cite> to the end of the keyword arg, makes the update call add
or remove items from the collection, without overwriting then entire column.</p>
<p>Given the model below, here are the operations that can be performed on the different container columns:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Row</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">row_id</span>      <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">set_column</span>  <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">Integer</span><span class="p">)</span>
    <span class="n">list_column</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">Integer</span><span class="p">)</span>
    <span class="n">map_column</span>  <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">Integer</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="xref py py-class docutils literal"><span class="pre">Set</span></code></p>
<ul class="simple">
<li><cite>add</cite>: adds the elements of the given set to the column</li>
<li><cite>remove</cite>: removes the elements of the given set to the column</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># add elements to a set</span>
<span class="n">Row</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="n">row_id</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">set_column__add</span><span class="o">=</span><span class="p">{</span><span class="mi">6</span><span class="p">})</span>

<span class="c1"># remove elements to a set</span>
<span class="n">Row</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="n">row_id</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">set_column__remove</span><span class="o">=</span><span class="p">{</span><span class="mi">4</span><span class="p">})</span>
</pre></div>
</div>
<p><code class="xref py py-class docutils literal"><span class="pre">List</span></code></p>
<ul class="simple">
<li><cite>append</cite>: appends the elements of the given list to the end of the column</li>
<li><cite>prepend</cite>: prepends the elements of the given list to the beginning of the column</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># append items to a list</span>
<span class="n">Row</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="n">row_id</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">list_column__append</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="c1"># prepend items to a list</span>
<span class="n">Row</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="n">row_id</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">list_column__prepend</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p><code class="xref py py-class docutils literal"><span class="pre">Map</span></code></p>
<ul class="simple">
<li><cite>update</cite>: adds the given keys/values to the columns, creating new entries if they didn’t exist, and overwriting old ones if they did</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># add items to a map</span>
<span class="n">Row</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="n">row_id</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">map_column__update</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>

<span class="c1"># remove items from a map</span>
<span class="n">Row</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="n">row_id</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">map_column__remove</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="cassandra.cqlengine.query.BatchQuery">
<em class="property">class </em><code class="descclassname">cassandra.cqlengine.query.</code><code class="descname">BatchQuery</code><span class="sig-paren">(</span><em>batch_type=None</em>, <em>timestamp=None</em>, <em>consistency=None</em>, <em>execute_on_exception=False</em>, <em>timeout=&lt;object object&gt;</em>, <em>connection=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#BatchQuery"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.BatchQuery" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles the batching of queries</p>
<p><a class="reference external" href="http://docs.datastax.com/en/cql/3.0/cql/cql_reference/batch_r.html">http://docs.datastax.com/en/cql/3.0/cql/cql_reference/batch_r.html</a></p>
<p>See <a class="reference internal" href="../../../cqlengine/batches.html"><span class="doc">Batch Queries</span></a> for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>batch_type</strong> (<a class="reference internal" href="../query.html#cassandra.query.BatchType" title="cassandra.query.BatchType"><em>BatchType</em></a><em>, </em><em>str</em><em> or </em><em>None</em>) – (optional) One of batch type values available through BatchType enum</li>
<li><strong>timestamp</strong> (<a class="reference internal" href="../query.html#cassandra.query.TraceEvent.datetime" title="cassandra.query.TraceEvent.datetime"><em>datetime</em></a><em> or </em><em>timedelta</em><em> or </em><em>None</em>) – (optional) A datetime or timedelta object with desired timestamp to be applied
to the batch conditional.</li>
<li><strong>consistency</strong> (The <a class="reference internal" href="../../cassandra.html#cassandra.ConsistencyLevel" title="cassandra.ConsistencyLevel"><code class="xref py py-class docutils literal"><span class="pre">ConsistencyLevel</span></code></a> to be used for the batch query, or None.) – (optional) One of consistency values (“ANY”, “ONE”, “QUORUM” etc)</li>
<li><strong>execute_on_exception</strong> (<em>bool</em>) – (Defaults to False) Indicates that when the BatchQuery instance is used
as a context manager the queries accumulated within the context must be executed despite
encountering an error within the context. By default, any exception raised from within
the context scope will cause the batched queries not to be executed.</li>
<li><strong>timeout</strong> (<em>float</em><em> or </em><em>None</em>) – (optional) Timeout for the entire batch (in seconds), if not specified fallback
to default session timeout</li>
<li><strong>connection</strong> (<em>str</em>) – Connection name to use for the batch execution</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cassandra.cqlengine.query.BatchQuery.add_query">
<code class="descname">add_query</code><span class="sig-paren">(</span><em>query</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#BatchQuery.add_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.BatchQuery.add_query" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.BatchQuery.execute">
<code class="descname">execute</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#BatchQuery.execute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.BatchQuery.execute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cassandra.cqlengine.query.BatchQuery.add_callback">
<code class="descname">add_callback</code><span class="sig-paren">(</span><em>fn</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#BatchQuery.add_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.BatchQuery.add_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a function and arguments to be passed to it to be executed after the batch executes.</p>
<p>A batch can support multiple callbacks.</p>
<p>Note, that if the batch does not execute, the callbacks are not executed.
A callback, thus, is an “on batch success” handler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fn</strong> (<em>callable</em>) – Callable object</li>
<li><strong>*args</strong> – Positional arguments to be passed to the callback at the time of execution</li>
<li><strong>**kwargs</strong> – Named arguments to be passed to the callback at the time of execution</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="cassandra.cqlengine.query.ContextQuery">
<em class="property">class </em><code class="descclassname">cassandra.cqlengine.query.</code><code class="descname">ContextQuery</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#ContextQuery"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.ContextQuery" title="Permalink to this definition">¶</a></dt>
<dd><p>A Context manager to allow a Model to switch context easily. Presently, the context only
specifies a keyspace for model IO.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>*args</strong> – One or more models. A model should be a class type, not an instance.</li>
<li><strong>**kwargs</strong> – (optional) Context parameters: can be <em>keyspace</em> or <em>connection</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ContextQuery</span><span class="p">(</span><span class="n">Automobile</span><span class="p">,</span> <span class="n">keyspace</span><span class="o">=</span><span class="s1">&#39;test2&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">A</span><span class="p">:</span>
    <span class="n">A</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">manufacturer</span><span class="o">=</span><span class="s1">&#39;honda&#39;</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="mi">2008</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;civic&#39;</span><span class="p">)</span>
    <span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>  <span class="c1"># 1 result</span>

<span class="k">with</span> <span class="n">ContextQuery</span><span class="p">(</span><span class="n">Automobile</span><span class="p">,</span> <span class="n">keyspace</span><span class="o">=</span><span class="s1">&#39;test4&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">A</span><span class="p">:</span>
    <span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>  <span class="c1"># 0 result</span>

<span class="c1"># Multiple models</span>
<span class="k">with</span> <span class="n">ContextQuery</span><span class="p">(</span><span class="n">Automobile</span><span class="p">,</span> <span class="n">Automobile2</span><span class="p">,</span> <span class="n">connection</span><span class="o">=</span><span class="s1">&#39;cluster2&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">A2</span><span class="p">):</span>
    <span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
    <span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">A2</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="cassandra.cqlengine.query.DoesNotExist">
<em class="property">class </em><code class="descclassname">cassandra.cqlengine.query.</code><code class="descname">DoesNotExist</code><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#DoesNotExist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.DoesNotExist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="cassandra.cqlengine.query.MultipleObjectsReturned">
<em class="property">class </em><code class="descclassname">cassandra.cqlengine.query.</code><code class="descname">MultipleObjectsReturned</code><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#MultipleObjectsReturned"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.MultipleObjectsReturned" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="cassandra.cqlengine.query.LWTException">
<em class="property">class </em><code class="descclassname">cassandra.cqlengine.query.</code><code class="descname">LWTException</code><span class="sig-paren">(</span><em>existing</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cassandra/cqlengine/query.html#LWTException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.cqlengine.query.LWTException" title="Permalink to this definition">¶</a></dt>
<dd><p>Lightweight conditional exception.</p>
<p>This exception will be raised when a write using an <cite>IF</cite> clause could not be
applied due to existing data violating the condition. The existing data is
available through the <code class="docutils literal"><span class="pre">existing</span></code> attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>existing</strong> – The current state of the data which prevented the write.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Cassandra Driver</a></h1>



<p class="blurb">Python driver for Cassandra</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=datastax&repo=python-driver&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../index.html#core-driver">Core Driver</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#object-mapper">Object Mapper</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="models.html"><code class="docutils literal"><span class="pre">cassandra.cqlengine.models</span></code> - Table models for object mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html"><code class="docutils literal"><span class="pre">cassandra.cqlengine.columns</span></code> - Column types for object mapping models</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="docutils literal"><span class="pre">cassandra.cqlengine.query</span></code> - Query and filter model objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#queryset">QuerySet</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="connection.html"><code class="docutils literal"><span class="pre">cassandra.cqlengine.connection</span></code> - Connection management for cqlengine</a></li>
<li class="toctree-l3"><a class="reference internal" href="management.html"><code class="docutils literal"><span class="pre">cassandra.cqlengine.management</span></code> - Schema management for cqlengine</a></li>
<li class="toctree-l3"><a class="reference internal" href="usertype.html"><code class="docutils literal"><span class="pre">cassandra.cqlengine.usertype</span></code> - Model classes for User Defined Types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../upgrading.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../execution_profiles.html">Execution Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../performance.html">Performance Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../query_paging.html">Paging Large Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../lwt.html">Lightweight Transactions (Compare-and-set)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_defined_types.html">User Defined Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../object_mapper.html">Object Mapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dates_and_times.html">Working with Dates and Times</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently Asked Questions</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">API Documentation</a><ul>
      <li>Previous: <a href="columns.html" title="previous chapter"><code class="docutils literal"><span class="pre">cassandra.cqlengine.columns</span></code> - Column types for object mapping models</a></li>
      <li>Next: <a href="connection.html" title="next chapter"><code class="docutils literal"><span class="pre">cassandra.cqlengine.connection</span></code> - Connection management for cqlengine</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2013-2017 DataStax.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../../_sources/api/cassandra/cqlengine/query.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>