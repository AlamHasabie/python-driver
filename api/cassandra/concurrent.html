
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="refresh" content="0; URL=https://docs.datastax.com/en/developer/python-driver/latest/api/cassandra/concurrent/">
    <link rel="canonical" href="https://docs.datastax.com/en/developer/python-driver/latest/api/cassandra/concurrent/">
    <title>cassandra.concurrent - Utilities for Concurrent Statement Execution &#8212; Cassandra Driver 3.13.0 documentation</title>
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.13.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="cassandra.connection - Low Level Connection Info" href="connection.html" />
    <link rel="prev" title="cassandra.decoder - Data Return Formats" href="decoder.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-cassandra.concurrent">
<span id="cassandra-concurrent-utilities-for-concurrent-statement-execution"></span><h1><code class="docutils literal"><span class="pre">cassandra.concurrent</span></code> - Utilities for Concurrent Statement Execution<a class="headerlink" href="#module-cassandra.concurrent" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="cassandra.concurrent.execute_concurrent">
<code class="descclassname">cassandra.concurrent.</code><code class="descname">execute_concurrent</code><span class="sig-paren">(</span><em>session</em>, <em>statements_and_parameters</em>, <em>concurrency=100</em>, <em>raise_on_first_error=True</em>, <em>results_generator=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/cassandra/concurrent.html#execute_concurrent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.concurrent.execute_concurrent" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes a sequence of (statement, parameters) tuples concurrently.  Each
<code class="docutils literal"><span class="pre">parameters</span></code> item must be a sequence or <code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</p>
<p>The <cite>concurrency</cite> parameter controls how many statements will be executed
concurrently.  When <a class="reference internal" href="cluster.html#cassandra.cluster.Cluster.protocol_version" title="cassandra.cluster.Cluster.protocol_version"><code class="xref py py-attr docutils literal"><span class="pre">Cluster.protocol_version</span></code></a> is set to 1 or 2,
it is recommended that this be kept below 100 times the number of
core connections per host times the number of connected hosts (see
<a class="reference internal" href="cluster.html#cassandra.cluster.Cluster.set_core_connections_per_host" title="cassandra.cluster.Cluster.set_core_connections_per_host"><code class="xref py py-meth docutils literal"><span class="pre">Cluster.set_core_connections_per_host()</span></code></a>).  If that amount is exceeded,
the event loop thread may attempt to block on new connection creation,
substantially impacting throughput.  If <a class="reference internal" href="cluster.html#cassandra.cluster.Cluster.protocol_version" title="cassandra.cluster.Cluster.protocol_version"><code class="xref py py-attr docutils literal"><span class="pre">protocol_version</span></code></a>
is 3 or higher, you can safely experiment with higher levels of concurrency.</p>
<p>If <cite>raise_on_first_error</cite> is left as <code class="xref py py-const docutils literal"><span class="pre">True</span></code>, execution will stop
after the first failed statement and the corresponding exception will be
raised.</p>
<p><cite>results_generator</cite> controls how the results are returned.</p>
<blockquote>
<div><p>If <code class="xref py py-const docutils literal"><span class="pre">False</span></code>, the results are returned only after all requests have completed.</p>
<p>If <code class="xref py py-const docutils literal"><span class="pre">True</span></code>, a generator expression is returned. Using a generator results in a constrained
memory footprint when the results set will be large – results are yielded
as they return instead of materializing the entire list at once. The trade for lower memory
footprint is marginal CPU overhead (more thread coordination and sorting out-of-order results
on-the-fly).</p>
</div></blockquote>
<p>A sequence of <code class="docutils literal"><span class="pre">ExecutionResult(success,</span> <span class="pre">result_or_exc)</span></code> namedtuples is returned
in the same order that the statements were passed in.  If <code class="docutils literal"><span class="pre">success</span></code> is <code class="xref py py-const docutils literal"><span class="pre">False</span></code>,
there was an error executing the statement, and <code class="docutils literal"><span class="pre">result_or_exc</span></code> will be
an <code class="xref py py-class docutils literal"><span class="pre">Exception</span></code>.  If <code class="docutils literal"><span class="pre">success</span></code> is <code class="xref py py-const docutils literal"><span class="pre">True</span></code>, <code class="docutils literal"><span class="pre">result_or_exc</span></code>
will be the query result.</p>
<p>Example usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">select_statement</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE id=?&quot;</span><span class="p">)</span>

<span class="n">statements_and_params</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">user_id</span> <span class="ow">in</span> <span class="n">user_ids</span><span class="p">:</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">statements_and_params</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">select_statement</span><span class="p">,</span> <span class="n">params</span><span class="p">))</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">execute_concurrent</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span> <span class="n">statements_and_params</span><span class="p">,</span> <span class="n">raise_on_first_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">success</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
        <span class="n">handle_error</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>  <span class="c1"># result will be an Exception</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">process_user</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># result will be a list of rows</span>
</pre></div>
</div>
<p>Note: in the case that <cite>generators</cite> are used, it is important to ensure the consumers do not
block or attempt further synchronous requests, because no further IO will be processed until
the consumer returns. This may also produce a deadlock in the IO event thread.</p>
</dd></dl>

<dl class="function">
<dt id="cassandra.concurrent.execute_concurrent_with_args">
<code class="descclassname">cassandra.concurrent.</code><code class="descname">execute_concurrent_with_args</code><span class="sig-paren">(</span><em>session</em>, <em>statement</em>, <em>parameters</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/cassandra/concurrent.html#execute_concurrent_with_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cassandra.concurrent.execute_concurrent_with_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Like <a class="reference internal" href="#cassandra.concurrent.execute_concurrent" title="cassandra.concurrent.execute_concurrent"><code class="xref py py-meth docutils literal"><span class="pre">execute_concurrent()</span></code></a>, but takes a single
statement and a sequence of parameters.  Each item in <code class="docutils literal"><span class="pre">parameters</span></code>
should be a sequence or <code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</p>
<p>Example usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">statement</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;INSERT INTO mytable (a, b) VALUES (1, ?)&quot;</span><span class="p">)</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
<span class="n">execute_concurrent_with_args</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">concurrency</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Cassandra Driver</a></h1>



<p class="blurb">Python driver for Cassandra</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=datastax&repo=python-driver&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#core-driver">Core Driver</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../cassandra.html"><code class="docutils literal"><span class="pre">cassandra</span></code> - Exceptions and Enums</a></li>
<li class="toctree-l3"><a class="reference internal" href="cluster.html"><code class="docutils literal"><span class="pre">cassandra.cluster</span></code> - Clusters and Sessions</a></li>
<li class="toctree-l3"><a class="reference internal" href="policies.html"><code class="docutils literal"><span class="pre">cassandra.policies</span></code> - Load balancing and Failure Handling Policies</a></li>
<li class="toctree-l3"><a class="reference internal" href="auth.html"><code class="docutils literal"><span class="pre">cassandra.auth</span></code> - Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="metadata.html"><code class="docutils literal"><span class="pre">cassandra.metadata</span></code> - Schema and Ring Topology</a></li>
<li class="toctree-l3"><a class="reference internal" href="metrics.html"><code class="docutils literal"><span class="pre">cassandra.metrics</span></code> - Performance Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="query.html"><code class="docutils literal"><span class="pre">cassandra.query</span></code> - Prepared Statements, Batch Statements, Tracing, and Row Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="pool.html"><code class="docutils literal"><span class="pre">cassandra.pool</span></code> - Hosts and Connection Pools</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocol.html"><code class="docutils literal"><span class="pre">cassandra.protocol</span></code> - Protocol Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="encoder.html"><code class="docutils literal"><span class="pre">cassandra.encoder</span></code> - Encoders for non-prepared Statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="decoder.html"><code class="docutils literal"><span class="pre">cassandra.decoder</span></code> - Data Return Formats</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="docutils literal"><span class="pre">cassandra.concurrent</span></code> - Utilities for Concurrent Statement Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="connection.html"><code class="docutils literal"><span class="pre">cassandra.connection</span></code> - Low Level Connection Info</a></li>
<li class="toctree-l3"><a class="reference internal" href="util.html"><code class="docutils literal"><span class="pre">cassandra.util</span></code> - Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="io/asyncioreactor.html"><code class="docutils literal"><span class="pre">cassandra.io.asyncioreactor</span></code> - <code class="docutils literal"><span class="pre">asyncio</span></code> Event Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="io/asyncorereactor.html"><code class="docutils literal"><span class="pre">cassandra.io.asyncorereactor</span></code> - <code class="docutils literal"><span class="pre">asyncore</span></code> Event Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="io/eventletreactor.html"><code class="docutils literal"><span class="pre">cassandra.io.eventletreactor</span></code> - <code class="docutils literal"><span class="pre">eventlet</span></code>-compatible Connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="io/libevreactor.html"><code class="docutils literal"><span class="pre">cassandra.io.libevreactor</span></code> - <code class="docutils literal"><span class="pre">libev</span></code> Event Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="io/geventreactor.html"><code class="docutils literal"><span class="pre">cassandra.io.geventreactor</span></code> - <code class="docutils literal"><span class="pre">gevent</span></code>-compatible Event Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="io/twistedreactor.html"><code class="docutils literal"><span class="pre">cassandra.io.twistedreactor</span></code> - Twisted Event Loop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#object-mapper">Object Mapper</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../upgrading.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../execution_profiles.html">Execution Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance.html">Performance Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../query_paging.html">Paging Large Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lwt.html">Lightweight Transactions (Compare-and-set)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_defined_types.html">User Defined Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../object_mapper.html">Object Mapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dates_and_times.html">Working with Dates and Times</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">API Documentation</a><ul>
      <li>Previous: <a href="decoder.html" title="previous chapter"><code class="docutils literal"><span class="pre">cassandra.decoder</span></code> - Data Return Formats</a></li>
      <li>Next: <a href="connection.html" title="next chapter"><code class="docutils literal"><span class="pre">cassandra.connection</span></code> - Low Level Connection Info</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2013-2017 DataStax.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/api/cassandra/concurrent.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>